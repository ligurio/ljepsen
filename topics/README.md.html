<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>Molly documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>molly</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Molly">Molly </a></li>
</ul>


<h2>Topics</h2>
<ul class="">
  <li><strong>README</strong></li>
</ul>
<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/molly.client.html">molly.client</a></li>
  <li><a href="../modules/molly.clock.html">molly.clock</a></li>
  <li><a href="../modules/molly.thread_coroutine.html">molly.thread_coroutine</a></li>
  <li><a href="../modules/molly.thread_fiber.html">molly.thread_fiber</a></li>
  <li><a href="../modules/molly.db.html">molly.db</a></li>
  <li><a href="../modules/molly.gen.html">molly.gen</a></li>
  <li><a href="../modules/molly.history.html">molly.history</a></li>
  <li><a href="../modules/molly.html">molly</a></li>
  <li><a href="../modules/molly.log.html">molly.log</a></li>
  <li><a href="../modules/molly.nemesis.html">molly.nemesis</a></li>
  <li><a href="../modules/molly.op.html">molly.op</a></li>
  <li><a href="../modules/molly.runner.html">molly.runner</a></li>
  <li><a href="../modules/molly.tests.html">molly.tests</a></li>
  <li><a href="../modules/molly.thread.html">molly.thread</a></li>
  <li><a href="../modules/molly.utils.html">molly.utils</a></li>
</ul>
<h2>Examples</h2>
<ul class="nowrap">
  <li><a href="../examples/sqlite-rw-register.lua.html">sqlite-rw-register.lua</a></li>
  <li><a href="../examples/sqlite-list-append.lua.html">sqlite-list-append.lua</a></li>
</ul>

</div>

<div id="content">

    <a href="https://github.com/ligurio/molly/actions/workflows/check.yaml"><img src="https://github.com/ligurio/molly/actions/workflows/check.yaml/badge.svg" alt="Static analysis"/></a>
<a href="https://github.com/ligurio/molly/actions/workflows/test.yaml"><img src="https://github.com/ligurio/molly/actions/workflows/test.yaml/badge.svg" alt="Testing"/></a>
<a href="https://coveralls.io/github/ligurio/molly?branch=dev"><img src="https://coveralls.io/repos/github/ligurio/molly/badge.svg?branch=dev" alt="Coverage Status"/></a></p>

<p><a name="Molly"></a></p>
<h2>Molly</h2>

<p>is a framework for distributed systems verification, with fault injection.</p>

<h3>Prerequisites</h3>

<ul>
    <li>Lua interpreter: LuaJIT or LuaJIT-based is recommended.</li>
    <li><a href="https://github.com/fab13n/checks">checks</a> - Lua library for easy, terse,
    readable and fast function arguments type checking.</li>
    <li><a href="https://luafun.github.io/">luafun</a> - Lua functional library.</li>
    <li><a href="https://github.com/mpx/lua-cjson">lua-cjson</a> - Lua library for fast JSON
    encoding and decoding.</li>
    <li>(optional) Jepsen-compatible consistency checker. For example
    <a href="https://github.com/ligurio/elle-cli">elle-cli</a>, based on Jepsen, Elle and
    Knossos.</li>
</ul>

<h3>Documentation</h3>

<p>See documentation in https://ligurio.github.io/molly/.</p>

<h3>Examples</h3>

<p>See also an examples in <a href="/test/examples/">test/examples/</a> for SQLite database
engine:
- <a href="../examples/sqlite-rw-register.lua.html#">sqlite-rw-register.lua</a> contains a simple test that concurrently runs <code>get</code>
  and <code>set</code> operations on SQLite DB
- <a href="../examples/sqlite-list-append.lua.html#">sqlite-list-append.lua</a> contains a simple test that concurrently runs <code>read</code>
  and <code>append</code> operations on SQLite DB</p>

<p>For running examples you need installed an SQLite development package and
<a href="https://github.com/luarocks/luarocks/wiki/Download">LuaRocks</a>.</p>


<pre>
$ sudo apt install -y sqlite3 libsqlite3-dev
$ make deps
$ make test-example
</pre>


<p>Example produces two files with history: <code>history.txt</code> and <code>history.json</code>. With
<a href="https://github.com/ligurio/elle-cli#usage">elle-cli</a> history can be checked
for consistency:</p>


<pre>
$ VER=<span class="number">0.1</span>.<span class="number">2</span>
$ curl -O -L https://github.com/ligurio/elle-cli/releases/download/${VER}/elle-cli-bin-${VER}.zip
$ unzip elle-cli-bin-${VER}.zip
$ java -jar ./target/elle-cli-${VER}-standalone.jar -m elle-rw-register history.json
history.json        <span class="keyword">true</span>
</pre>


<h3>Why?</h3>

<ul>
    <li><strong>Simple language</strong>. <a href="https://www.lua.org/about.html">Lua</a> is simple, but
    not simplistic: Lua has a simple, yet powerful syntax which fits on a single
    page. The semantics are consistent and intuitive.</li>
    <li><strong>Seamless integration with C and C++ source code</strong>. LuaJIT's FFI is a quite
    fast and simple mechanism allowing to call C functions directly. LuaJIT's FFI
    is <a href="https://nullprogram.com/blog/2018/05/27/">substantially faster than C</a>.
    It's about 25% faster than a native C function call to a shared object
    function.</li>
    <li><strong>Fast and powerful generators</strong>. <a href="../modules/molly.html#">molly</a> uses Lua functional library that
    allows to build generators with exceptional performance, most of them produce
    about 0.8-1.4M ops per second. In the same time Jepsen generators are slow:
    "Realistic generator tests yield rates over 20,000 operations/sec, which
    seems more than sufficient for Jepsen's purposes.". 20k ops/sec is not so
    much for testing of real production systems.</li>
    <li><strong>Cooperative multitasking</strong>. Cooperative multitasking is less error-prone
    than preemptive one. Jepsen library has a problems with multithreading, that
    Kyle Kingsbury "have never had the chance to dig in and fix".</li>
    <li><strong>Modern transactional safety checkers</strong>. The main strength of Jepsen is
    it's transational safety checkers. <a href="../modules/molly.html#">molly</a> provides the same level of
    confidence as an original Jepsen library because of using
    <a href="https://github.com/ligurio/elle-cli">elle-cli</a> built on top of Elle, Knossos
    and Jepsen's consistency checkers.</li>
</ul>

<h3>Installation</h3>

<ul>
    <li>Download and setup Lua interpreter, <a href="https://luajit.org/install.html">LuaJIT</a>
    or LuaJIT-based is recommended (for example
    <a href="https://www.tarantool.io/download/">Tarantool</a>).</li>
    <li>Install library using LuaRocks:</li>
</ul>


<pre>
$ luarocks install <span class="comment">--local --server=https://luarocks.org/dev molly</span>
</pre>


<p>NOTE: Installation of modules <code>luafun</code> and <code>lua-cjson</code> is not required when
Tarantool is used, both modules are built-in there. However these modules are
included to the rockspec for user's convenience.</p>

<h3>Hacking</h3>

<p>For developing <a href="../modules/molly.html#">molly</a> you need to install: either LuaJIT or LuaJIT-based
and <a href="https://github.com/luarocks/luarocks/wiki/Download">LuaRocks</a>.</p>


<pre>
$ make deps
$ export PATH=$PATH:$(luarocks path <span class="comment">--lr-bin)
</span>$ eval $(luarocks path)
$ make luacheck
$ make test
</pre>


<p>You are ready to make patches!</p>

<h3>License</h3>

<p>Copyright Â© 2021-2022 <a href="https://bronevichok.ru/">Sergey Bronnikov</a></p>

<p>Distributed under the ISC License.

</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2022-05-21 14:23:38 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
