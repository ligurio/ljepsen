<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
   "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8"/>
<head>
    <title>ljepsen documentation</title>
    <link rel="stylesheet" href="../ldoc.css" type="text/css" />
</head>
<body>

<div id="container">

<div id="product">
	<div id="product_logo"></div>
	<div id="product_name"><big><b></b></big></div>
	<div id="product_description"></div>
</div> <!-- id="product" -->


<div id="main">


<!-- Menu -->

<div id="navigation">
<br/>
<h1>ljepsen</h1>

<ul>
  <li><a href="../index.html">Index</a></li>
</ul>

<h2>Contents</h2>
<ul>
<li><a href="#Functions">Functions</a></li>
</ul>


<h2>Modules</h2>
<ul class="nowrap">
  <li><a href="../modules/ljepsen.checker.html">ljepsen.checker</a></li>
  <li><strong>ljepsen.client</strong></li>
  <li><a href="../modules/ljepsen.clock.html">ljepsen.clock</a></li>
  <li><a href="../modules/ljepsen.thread_coroutine.html">ljepsen.thread_coroutine</a></li>
  <li><a href="../modules/ljepsen.thread_fiber.html">ljepsen.thread_fiber</a></li>
  <li><a href="../modules/ljepsen.db.html">ljepsen.db</a></li>
  <li><a href="../modules/ljepsen.gen.html">ljepsen.gen</a></li>
  <li><a href="../modules/ljepsen.histogram.html">ljepsen.histogram</a></li>
  <li><a href="../modules/ljepsen.history.html">ljepsen.history</a></li>
  <li><a href="../modules/ljepsen.html">ljepsen</a></li>
  <li><a href="../modules/ljepsen.log.html">ljepsen.log</a></li>
  <li><a href="../modules/ljepsen.nemesis.html">ljepsen.nemesis</a></li>
  <li><a href="../modules/ljepsen.op.html">ljepsen.op</a></li>
  <li><a href="../modules/ljepsen.runner.html">ljepsen.runner</a></li>
  <li><a href="../modules/ljepsen.thread.html">ljepsen.thread</a></li>
  <li><a href="../modules/ljepsen.utils.html">ljepsen.utils</a></li>
</ul>
<h2>Topics</h2>
<ul class="">
  <li><a href="../topics/README.md.html">README</a></li>
</ul>
<h2>Examples</h2>
<ul class="nowrap">
  <li><a href="../examples/sqlite.lua.html">sqlite.lua</a></li>
</ul>

</div>

<div id="content">

<h1>Module <code>ljepsen.client</code></h1>
<p>Module with default Jepsen client.</p>
<p>


<h3>Clients</h3>

<ul>
    <li><strong>rw-register</strong> concurrent atomic updates to a shared register.</li>
    <li><strong>list-append</strong> operations are either appends or reads. Detects cycles in
    histories where operations are transactions over named lists lists.</li>
    <li><strong>bank</strong> concurrent transfers between rows of a shared table.</li>
</ul>

<h3>Bank</h3>

<p> Test simulates a set of bank accounts, one per row, and transfers money
 between them at random, ensuring that no account goes negative. Under
 snapshot isolation, one can prove that transfers must serialize, and the
 sum of all accounts is conserved. Meanwhile, read transactions select
 the current balance of all accounts. Snapshot isolation ensures those
 reads see a consistent snapshot, which implies the sum of accounts in
 any read is constant as well.</p>

<p> The bank test stresses several invariants provided by snapshot
 isolation. We construct a set of bank accounts, each with three
 attributes:</p>

<ul>
    <li><em>type</em>, which is always "account". We use this to query for all
    accounts.</li>
    <li><em>key</em>, an integer which identifies that account.</li>
    <li><em>amount</em>, the amount of money in that account.</li>
</ul>

<p> Our test begins with a fixed amount ($100) of money in a single account,
 and proceeds to randomly transfer money between accounts. Transfers
 proceed by reading two random accounts by key, and writing back new
 amounts for those accounts to reflect some money moving between them.
 Concurrently, clients read all accounts to observe the total state of
 the system.</p>

<p> Bank: simulated bank accounts including transfers between accounts
 (using transactions).</p>

<p> Claim: the total of all accounts should be consistent. Required for:
 snapshot isolation.</p>

<h3>Append</h3>

<p> The <em>append</em> test models the database as a collection of named lists,
 and performs transactions comprised of read and append operations. A
 read returns the value of a particular list, and an append adds a single
 unique element to the end of a particular list. We derive ordering
 dependencies between these transactions, and search for cycles in that
 dependency graph to identify consistency anomalies.</p>

<p> In terms of Jepsen values in operation are lists of integers. Each operation
 performs a transaction, comprised of micro-operations which are either reads of
 some value (returning the entire list) or appends (adding a single number to
 whatever the present value of the given list is). We detect cycles in these
 transactions using Jepsen's cycle-detection system.</p>

<h3>Register</h3>

<p> Register: read and writes operations on registers.</p>

<p> Claim: the operations should be linearizable.
 Required for: snapshot isolation.</p>
</p>
    <h3>See also:</h3>
    <ul>
         <a href="../modules/ljepsen.gen.html#">ljepsen.gen</a>
    </ul>


<h2><a href="#Functions">Functions</a></h2>
<table class="function_list">
	<tr>
	<td class="name" nowrap><a href="#new">new ()</a></td>
	<td class="summary">Function that returns a default client implementation.</td>
	</tr>
</table>

<br/>
<br/>


    <h2 class="section-header "><a name="Functions"></a>Functions</h2>

    <dl class="function">
    <dt>
    <a name = "new"></a>
    <strong>new ()</strong>
    </dt>
    <dd>
    Function that returns a default client implementation.
 Jepsen client must implement following methods:</p>

<ul>
    <li><strong>open</strong> - function that open a connection to a database instance</li>
    <li><strong>setup</strong> - function that set up a database instance</li>
    <li><strong>invoke</strong> - function that accept an operation and invoke it on database instance</li>
    <li><strong>teardown</strong> - function that tear down a database instance</li>
    <li><strong>close</strong> - function that close connection to a database instance</li>
</ul>

<p> Default implementation of a client defines open, setup, teardown and close
 methods with empty implementation that always returns true.



    <h3>Returns:</h3>
    <ol>

        client
    </ol>



    <h3>Usage:</h3>
    <ul>
        <pre class="example"><span class="keyword">local</span> client = <span class="global">require</span>(<span class="string">'ljepsen.client'</span>)
<span class="keyword">local</span> cl = client.new()
cl.invoke = <span class="keyword">function</span>(op)
<span class="keyword">end</span></pre>
    </ul>

</dd>
</dl>


</div> <!-- id="content" -->
</div> <!-- id="main" -->
<div id="about">
<i>generated by <a href="http://github.com/stevedonovan/LDoc">LDoc 1.4.6</a></i>
<i style="float:right;">Last updated 2022-02-19 08:28:07 </i>
</div> <!-- id="about" -->
</div> <!-- id="container" -->
</body>
</html>
